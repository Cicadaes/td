<div class="shadow-content">
  <!-- 页眉 -->
  <div class="header module-title">
    渠道管理
    <div class="title-right">
      <nz-popover [nzTitle]="'指标说明'" [nzPlacement]="'rightTop'" [nzTrigger]="'hover'">
        <i nz-icon type="question-circle" class="tip-icon question" theme="outline" nz-popover></i>
        <ng-template #nzTemplate>
          <ul class="des-ul">
            <li class="clrfix">
              <label>渠道名称: </label>
              <div class="des">
                通过sdk采集上报上来的渠道标识字段值。
              </div>
            </li>
            <li class="clrfix">
              <label>显示名：</label>
              <div class="des">
                为了便于业务理解为每个渠道字段值起的别名，也会作为渠道分析、渠道筛选器内每个渠道对应的显示名。
              </div>
            </li>
            <li class="clrfix">
              <label>登记时间: </label>
              <div class="des">
                首次统计到此渠道数据的时间。
              </div>
            </li>
            <li class="clrfix">
              <label>报表显示状态：</label>
              <div class="des">
                可控制每个渠道的报表显示状态为“显示/隐藏”状态。隐藏状态下的渠道将不被统计且不显示在渠道分析、渠道筛选器等相关模块内。此功能，可以避免太多无效渠道影响报表展示。
              </div>
            </li>
            <li class="clrfix">
              <label>数据采集状态: </label>
              <div class="des">
                可控制每个渠道的采集状态为“启用/停用”。停用状态下的渠道将不会被采集。
              </div>
            </li>
          </ul>
        </ng-template>
      </nz-popover>
    </div>
  </div>

  <!-- 搜索 -->
  <app-more-search [fieldArray]="_moreSearchFieldArray" (onSearch)="onSearchMoreSearch($event)"></app-more-search>

  <!-- 内容 -->
  <div class="content">
    <nz-table
      #channelTable
      [nzLoading]="loading"
      [nzData]="listOfChannel"
      [nzTotal]="totalCount"
      [(nzPageIndex)]="pageIndex"
      [(nzPageSize)]="pageSize"
      (nzPageIndexChange)="changePage()"
      (nzPageSizeChange)="changePage(true)"
      [nzPageSizeOptions]="pageOptions"
      nzShowSizeChanger
      [nzFrontPagination]="false"
    >
      <thead>
        <tr>
          <th>渠道名称</th>
          <th>显示名</th>
          <th>渠道类型</th>
          <th>登记时间</th>
          <th>报表显示状态</th>
          <th>数据采集状态</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of channelTable.data">
          <!-- 渠道名称 -->
          <td style="width: 25%">
            {{ data.dicItemValue }}
          </td>

          <!-- 显示名 -->
          <td style="width: 25%">
            <ng-container *ngIf="!data.isEditName">
              {{ data.dicItemAlias || '--' }}<a (click)="editAlias(data)" class="edit-enter"></a>
            </ng-container>
            <ng-container *ngIf="data.isEditName">
              <input class="input-text" type="text" nz-input [(ngModel)]="data.dicItemAlias" maxlength="128" />
              <a (click)="editAlias(data, true)" class="edit-ok"></a>
              <a (click)="editAlias(data, false)" class="edit-cancel"></a>
            </ng-container>
          </td>

          <!-- 渠道类型 -->
          <td>
            {{ channelTypeMap[data.dicItemKey] }}
          </td>

          <!-- 登记时间 -->
          <td>
            {{ data.createTime | dateFormatPipe }}
          </td>

          <!-- 报表显示状态 -->
          <td>
            <nz-switch
              [ngModel]="data.status"
              (ngModelChange)="changeReportStatus(data, $event)"
              nzCheckedChildren="显示"
              nzUnCheckedChildren="隐藏"
            ></nz-switch>
          </td>

          <!-- 数据采集状态 -->
          <td>
            <nz-switch
              [ngModel]="data.collectDataStatus"
              (ngModelChange)="changeCollectDataStatus(data, $event)"
              nzCheckedChildren="启用"
              nzUnCheckedChildren="停用"
            ></nz-switch>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>
</div>
