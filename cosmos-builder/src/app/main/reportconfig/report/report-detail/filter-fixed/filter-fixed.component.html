<div>
    <div class="filter-create" [ngStyle]="positionStyles">
        <div class="create-title">
            <span>{{title}}过滤条件</span>
            <span (click)="isShow(false,'close')">
                <i class="anticon anticon-close"></i>
            </span>
        </div>
        <div class="create-field">
            <div class="field-title">
                <div class="field-title-left">
                    <span>名称</span>
                    <div class="input-text">
                        <input type="text" placeholder="请输入" [(ngModel)]="name" class="text" (ngModelChange)="changeName(name)" (blur)="changeName(name)">
                        <div class="text-explain" *ngIf="andArr.nameRequired">不能为空</div>
                        <div class="text-explain" *ngIf="andArr.nameRepeat">该名称已存在</div>
                    </div>
                </div>
                <!-- <div class="field-title-right">
                <span>数据源</span>
                <div class="input-text">
                    <input type="text" value="{{dataSource}}" readonly class="text">
                </div>
            </div> -->
            </div>
            <div class="field-content">
                <div class="content-and" *ngFor="let and of andArr;">
                    <ul>
                        <li *ngFor="let or of and.orArr;">
                            <div style="width:120px;">
                                <cm-select>
                                    <nz-select [(ngModel)]="or.option1" (ngModelChange)="isChanges(or)">
                                        <nz-option *ngFor="let option of options1" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                            </div>
                            <div>
                                <cm-select>
                                    <nz-select [(ngModel)]="or.option2" [nzPlaceHolder]="'选择字段'" (ngModelChange)="selectField(or.option2,or)">
                                        <nz-option *ngFor="let option of or.options" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                            </div>

                            <div *ngIf="or.showDateOption">
                                <cm-select>
                                    <nz-select [(ngModel)]="or.option3" [nzPlaceHolder]="'选择条件'" (ngModelChange)="selectChange(or,or.option3)">
                                        <nz-option *ngFor="let option of options3" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                            </div>
                            <div *ngIf="or.showElseOption">
                                <cm-select>
                                    <nz-select [(ngModel)]="or.option3" [nzPlaceHolder]="'选择条件'" (ngModelChange)="selectChange(or,or.option3)">
                                        <nz-option *ngFor="let option of options4" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                            </div>
                            <div *ngIf="or.showindexOption">
                                <cm-select>
                                    <nz-select [(ngModel)]="or.option3" [nzPlaceHolder]="'选择条件'" (ngModelChange)="selectChange(or,or.option3)">
                                        <nz-option *ngFor="let option of options5" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                            </div>

                            <div *ngIf="or.textSelect.showInput">
                                <input type="text" placeholder="例如" class="text" [(ngModel)]="or.option4" (blur)="verification(or,or.option4,'number',1)" (ngModelChange)="verification(or,or.option4,'number',1)">
                                <div class="text-explain" *ngIf="or.required && or.textSelect.showInput">不能为空</div>
                                <div class="text-explain" *ngIf="or.numErr&&or.textSelect.showInput">请输入数字</div>
                            </div>
                            <div *ngIf="or.textSelect.showTwoInput" class="section">
                                <div class="twoPos">
                                    <input type="text" placeholder="请输入" class="text" [(ngModel)]="or.option4[0].value" (blur)="verification(or.option4[0],or.option4[0].value,'number',2)" (ngModelChange)="verification(or.option4[0],or.option4[0].value,'number',2)">
                                    <div class="text-explain" *ngIf="or.option4[0].required&&or.textSelect.showTwoInput">不能为空</div>
                                    <div class="text-explain" *ngIf="or.option4[0].numErr&&or.textSelect.showTwoInput">请输入数字</div>
                                </div>
                                <span>至</span>
                                <div class="twoPos">
                                    <input type="text" placeholder="请输入" class="text" [(ngModel)]="or.option4[1].value" (blur)="verification(or.option4[1],or.option4[1].value,'number',2)" (ngModelChange)="verification(or.option4[1],or.option4[1].value,'number',2)">
                                    <div class="text-explain" *ngIf="or.option4[1].required&&or.textSelect.showTwoInput">不能为空</div>
                                    <div class="text-explain" *ngIf="or.option4[1].numErr&&or.textSelect.showTwoInput">请输入数字</div>
                                </div>
                            </div>
                            <div *ngIf="or.textSelect.showManyInput">
                                <input type="text" placeholder="例如:value1,value2,value3" class="text" [(ngModel)]="or.option4" (blur)="verification(or,or.option4,'manyString',1)" (ngModelChange)="verification(or,or.option4,'manyString',1)">
                                <div class="text-explain" *ngIf="or.required && or.textSelect.showManyInput">不能为空</div>
                                <div class="text-explain" *ngIf="or.numErr&&or.textSelect.showManyInput">请输入数字</div>
                                <div class="text-explain" *ngIf="or.symbolErr&&or.textSelect.showManyInput">请使用英文逗号分隔</div>
                            </div>
                            <div *ngIf="or.textSelect.showDate">
                                <cm-datepicker>
                                    <ng-template>
                                        <nz-datepicker [(ngModel)]="or.option4" (ngModelChange)="filterDate(or,or.option4)"></nz-datepicker>
                                    </ng-template>
                                </cm-datepicker>
                                <div class="text-explain" *ngIf="or.required&&or.textSelect.showDate">不能为空</div>
                            </div>
                            <div *ngIf="or.textSelect.showTwoDate" style="width:260px;">
                                <cm-datepicker>
                                    <ng-template>
                                        <nz-rangepicker [(ngModel)]="or._dateRange" (ngModelChange)="filterDate(or,$event)" [nzFormat]="'YYYY-MM-DD'"></nz-rangepicker>
                                    </ng-template>
                                </cm-datepicker>
                                <div class="text-explain" *ngIf="or.required&&or.textSelect.showTwoDate">不能为空</div>
                            </div>
                            <div *ngIf="or.textSelect.showCheckcascader">
                                <!-- <cm-checkcascader cmChangeOnSelect [cmOptions]="or.cityOption" [(ngModel)]="or.option5" (cmSelectionChange)="checkcascader(or,$event)" [cmLoadData]="loadData" placeholder="'请选择'">
                                </cm-checkcascader> -->
                                <cm-checkcascader cmChangeOnSelect [cmOptions]="or.cityOption" [(ngModel)]="or.option5" (cmSelectionChange)="checkcascader(or,$event)" placeholder="'请选择'">
                                </cm-checkcascader>
                                <div class="text-explain" *ngIf="or.required&&or.textSelect.showCheckcascader">不能为空</div>
                            </div>
                            <div *ngIf="or.textSelect.showCascader">
                                <!-- <nz-cascader nzChangeOnSelect [nzOptions]="or.cityOption" [(ngModel)]="or.option5" (nzSelectionChange)="cascader(or,$event)" [nzPlaceHolder]="'请选择'" (nzLoad)="loadData($event)">
                                    </nz-cascader> -->
                                <cm-cascader nzChangeOnSelect [nzOptions]="or.cityOption" [(ngModel)]="or.option5" (nzSelectionChange)="cascader(or,$event)" [nzPlaceHolder]="'请选择'">
                                </cm-cascader>
                                <div class="text-explain" *ngIf="or.required&&or.textSelect.showCascader">不能为空</div>
                            </div>
                            <div *ngIf="or.textSelect.showCheckSelect">
                                <cm-select>
                                    <nz-select style="width: 260px;" [nzMode]="'multiple'" [nzPlaceHolder]="'请选择'" [(ngModel)]="or.option4" (ngModelChange)="selectedChange(or,or.option4)" [nzNotFoundContent]="'无法找到'">
                                        <nz-option *ngFor="let option of searchOptions" [nzLabel]="option.label" [nzValue]="option.value">
                                        </nz-option>
                                    </nz-select>
                                </cm-select>
                                <div class="text-explain" *ngIf="or.required&&or.textSelect.showCheckSelect">不能为空</div>
                            </div>


                            <span class="or" (click)="addLi(and,or)" [ngClass]="or.firstClick? 'disabled':''">或</span>
                            <span class="icon" (click)="delectLi(and.id,or.id)">
                                <i class="anticon anticon-close-circle"></i>
                            </span>
                        </li>
                    </ul>
                    <p *ngIf="and.orArr.length>0" (click)="addUl(and)" [ngClass]="and.firstClick? 'disabled':''">与</p>
                </div>
            </div>
        </div>
        <div class="create-save">
            <span>此过滤器包含{{length}}个字句</span>
            <cm-button>
                <button nz-button [nzType]="'primary'" (click)="isShow(false,'save')" [disabled]="disabled">
                    <span>保存</span>
                </button>
            </cm-button>
        </div>
    </div>
    <div class="wrap" *ngIf="isCreate"></div>
</div>