"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
Object.defineProperty(exports, "__esModule", { value: true });
const core_1 = require("@angular/core");
const convert_1 = require("./convert");
let TableDocComponent = class TableDocComponent {
    /////
    constructor(el) {
        this.el = el;
        this._pageSize = 10;
        this._current = 1;
        this._isInit = false;
        this._isAjax = false;
        this._dataSet = [];
        this.data = [];
        this._isPagination = true;
        this._showSizeChanger = false;
        this._showQuickJumper = false;
        this._showTotal = false;
        this._isPageIndexReset = true;
        this.nzPageSizeChange = new core_1.EventEmitter();
        this.nzPageIndexChange = new core_1.EventEmitter();
        this.nzPageIndexChangeClick = new core_1.EventEmitter();
        this.nzDataChange = new core_1.EventEmitter();
        this.nzPageSizeSelectorValues = [10, 20, 30, 40, 50];
    }
    /////
    set langleft(left) {
        this._langleft = left;
    }
    ;
    set langright(right) {
        this._langright = right;
    }
    ;
    set basics(basics) {
        this._basics = basics;
    }
    ;
    set frame(frame) {
        this._frame = frame;
    }
    ;
    set datas(data) {
        this._datas = data;
        // ;
        for (let i = 0; i < this._datas.length; i++) {
            if ("fixed" in this._datas[i]) {
                if (this._datas[i].fixed == "left") {
                    this._langleft = this._datas[i].fixed;
                    this._fixedwidthleft = this._datas[i].width;
                }
                if (this._datas[i].fixed == "right") {
                    this._langright = this._datas[i].fixed;
                    this._fixedwidthrigth = this._datas[i].width;
                    this._height = (this._datas.length + 1) * 32 + "px";
                    // ;
                }
            }
        }
    }
    ;
    set widthleft(fixedwidth) {
        this._fixedwidthleft = fixedwidth;
    }
    ;
    set widthright(fixedwidth) {
        this._fixedwidthrigth = fixedwidth;
    }
    ;
    ////////////////////////////
    set nzDataSource(value) {
        this._dataSet = value;
        this.nzTotal = this._dataSet.length;
        this._generateData(true);
    }
    get nzDataSource() {
        return this._dataSet;
    }
    set nzIsPagination(value) {
        this._isPagination = convert_1.toBoolean(value);
    }
    get nzIsPagination() {
        return this._isPagination;
    }
    set nzShowSizeChanger(value) {
        this._showSizeChanger = convert_1.toBoolean(value);
    }
    get nzShowSizeChanger() {
        return this._showSizeChanger;
    }
    set nzShowQuickJumper(value) {
        this._showQuickJumper = convert_1.toBoolean(value);
    }
    get nzShowQuickJumper() {
        return this._showQuickJumper;
    }
    set nzShowTotal(value) {
        this._showTotal = convert_1.toBoolean(value);
    }
    get nzShowTotal() {
        return this._showTotal;
    }
    set nzPageSize(value) {
        if (this._pageSize === value) {
            return;
        }
        this._pageSize = value;
        this._generateData();
        if (this._isInit) {
            this.nzPageSizeChange.emit(value);
        }
    }
    get nzPageSize() {
        return this._pageSize;
    }
    set nzTotal(value) {
        if (this._total === value) {
            return;
        }
        this._total = value;
    }
    get nzTotal() {
        return this._total;
    }
    set nzPageIndex(value) {
        if (this._current === value) {
            return;
        }
        this._current = value;
        this._generateData();
        this.nzPageIndexChange.emit(this.nzPageIndex);
    }
    get nzPageIndex() {
        return this._current;
    }
    set nzIsPageIndexReset(value) {
        this._isPageIndexReset = convert_1.toBoolean(value);
    }
    get nzIsPageIndexReset() {
        return this._isPageIndexReset;
    }
    _generateData(forceRefresh = false) {
        ;
        if (!this._isAjax) {
            if (this.nzIsPagination) {
                if (forceRefresh) {
                    if (this.nzIsPageIndexReset) {
                        this.nzPageIndex = 1;
                    }
                    else {
                        const maxPageIndex = Math.ceil(this._dataSet.length / this.nzPageSize);
                        this.nzPageIndex = !this.nzPageIndex ? 1 : (this.nzPageIndex > maxPageIndex ? maxPageIndex : this.nzPageIndex);
                    }
                }
                this.data = this._dataSet.slice((this.nzPageIndex - 1) * this.nzPageSize, this.nzPageIndex * this.nzPageSize);
            }
            else {
                this.data = this._dataSet;
            }
            this.nzDataChange.emit(this.data);
        }
    }
    pageChangeClick(value) {
        this.nzPageIndexChangeClick.emit(value);
    }
    ngOnInit() {
    }
    ;
    ngOnDestroy() {
    }
    ;
};
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], TableDocComponent.prototype, "nzPageSizeChange", void 0);
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], TableDocComponent.prototype, "nzPageIndexChange", void 0);
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], TableDocComponent.prototype, "nzPageIndexChangeClick", void 0);
__decorate([
    core_1.Output(),
    __metadata("design:type", core_1.EventEmitter)
], TableDocComponent.prototype, "nzDataChange", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "langleft", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "langright", null);
__decorate([
    core_1.ContentChild(core_1.TemplateRef),
    __metadata("design:type", core_1.TemplateRef)
], TableDocComponent.prototype, "template", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "basics", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "frame", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "datas", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "widthleft", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object),
    __metadata("design:paramtypes", [Object])
], TableDocComponent.prototype, "widthright", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Array),
    __metadata("design:paramtypes", [Array])
], TableDocComponent.prototype, "nzDataSource", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], TableDocComponent.prototype, "nzIsPagination", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], TableDocComponent.prototype, "nzShowSizeChanger", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Object)
], TableDocComponent.prototype, "nzPageSizeSelectorValues", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], TableDocComponent.prototype, "nzShowQuickJumper", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], TableDocComponent.prototype, "nzShowTotal", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", String)
], TableDocComponent.prototype, "nzSize", void 0);
__decorate([
    core_1.Input(),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], TableDocComponent.prototype, "nzPageSize", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], TableDocComponent.prototype, "nzTotal", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Number),
    __metadata("design:paramtypes", [Number])
], TableDocComponent.prototype, "nzPageIndex", null);
__decorate([
    core_1.Input(),
    __metadata("design:type", Boolean),
    __metadata("design:paramtypes", [Boolean])
], TableDocComponent.prototype, "nzIsPageIndexReset", null);
TableDocComponent = __decorate([
    core_1.Component({
        selector: 'cmt-table',
        template: `
      <div style="width:100%;overflow-x: auto;">
          <div *ngIf="_langleft=='left'" [ngStyle]="{'width':_fixedwidthleft}" style="position:absolute;top:0;box-shadow:rgba(0, 0, 0, 0.2) 2px 0px 6px -2px;overflow:hidden">
              <table [ngClass]="{'basics': _basics, 'frame':_frame}" cellspacing="0" cellpadding="0">
                  <!--basics:基础;frame:外框;-->
                  <ng-container [ngTemplateOutlet]="template"></ng-container>
              </table>
          </div>
          <div>
              <table [ngClass]="{'basics': _basics, 'frame':_frame}" cellspacing="0" cellpadding="0">
                  <ng-container [ngTemplateOutlet]="template"></ng-container>
              </table>
          </div>
          <div *ngIf="_langright=='right'" [ngStyle]="{'width':_fixedwidthrigth,'height':_height}" style="border:1px solid #ccc;border-left:none;border-bottom:none;width:200px;position:absolute;top:0;right:0;box-shadow:rgba(0, 0, 0, 0.2) -2px 0px 6px -2px;overflow:hidden">
              <div style="position:relative;">
                  <div style="position: absolute;right: 0;">
                      <table [ngClass]="{'basics': _basics}" cellspacing="0" cellpadding="0">
                          <ng-container [ngTemplateOutlet]="template"></ng-container>
                      </table>
                  </div>
              </div>
          </div>
      </div>
      <nz-pagination *ngIf="nzIsPagination&&data.length" [nzInTable]="true" [nzShowSizeChanger]="nzShowSizeChanger" [nzPageSizeSelectorValues]="nzPageSizeSelectorValues" [nzShowQuickJumper]="nzShowQuickJumper" [nzShowTotal]="nzShowTotal" [nzSize]="(nzSize=='middle'||nzSize=='small')?'small':''"
          [(nzPageSize)]="nzPageSize" [nzTotal]="nzTotal" [(nzPageIndex)]="nzPageIndex" (nzPageIndexClickChange)="pageChangeClick($event)">
      </nz-pagination>
    `,
        styles: [`
      table {
        border-collapse: collapse;
        border-spacing: 0;
      }
      .basics {
        width: 100%;
        table-layout: fixed;
      }
      .basics table tbody tr:hover {
        background: red;
      }
      .frame {
        border: 1px solid #cccccc;
      }
    `],
    }),
    __metadata("design:paramtypes", [core_1.ElementRef])
], TableDocComponent);
exports.TableDocComponent = TableDocComponent;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJ1c2luZXNzL3RhYmxlL3RhYmxlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBLHdDQUFzSTtBQUN0SSx1Q0FBc0M7QUErQ3RDLElBQWEsaUJBQWlCLEdBQTlCO0lBd0JJLEtBQUs7SUFDTCxZQUFvQixFQUFjO1FBQWQsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQWZsQyxjQUFTLEdBQUcsRUFBRSxDQUFDO1FBRWYsYUFBUSxHQUFHLENBQUMsQ0FBQztRQUNiLFlBQU8sR0FBRyxLQUFLLENBQUM7UUFDaEIsWUFBTyxHQUFHLEtBQUssQ0FBQztRQUNoQixhQUFRLEdBQVUsRUFBRSxDQUFDO1FBQ3JCLFNBQUksR0FBVSxFQUFFLENBQUM7UUFFVCxrQkFBYSxHQUFHLElBQUksQ0FBQztRQUNyQixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUFDekIscUJBQWdCLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLGVBQVUsR0FBRyxLQUFLLENBQUM7UUFDbkIsc0JBQWlCLEdBQUcsSUFBSSxDQUFDO1FBT3ZCLHFCQUFnQixHQUF5QixJQUFJLG1CQUFZLEVBQUUsQ0FBQztRQUM1RCxzQkFBaUIsR0FBeUIsSUFBSSxtQkFBWSxFQUFFLENBQUM7UUFDN0QsMkJBQXNCLEdBQXlCLElBQUksbUJBQVksRUFBRSxDQUFDO1FBQ2xFLGlCQUFZLEdBQXdCLElBQUksbUJBQVksRUFBRSxDQUFDO1FBdUV4RCw2QkFBd0IsR0FBRyxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQztJQTVFekQsQ0FBQztJQU9ELEtBQUs7SUFFTCxJQUFJLFFBQVEsQ0FBQyxJQUFTO1FBQ2xCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0lBQzFCLENBQUM7SUFBQSxDQUFDO0lBRUYsSUFBSSxTQUFTLENBQUMsS0FBVTtRQUNwQixJQUFJLENBQUMsVUFBVSxHQUFHLEtBQUssQ0FBQztJQUM1QixDQUFD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TUQ7SUFEQyxZQUFLLEVBQUU7OztvREFRUDtBQU9EO0lBREMsWUFBSyxFQUFFOzs7MkRBR1A7QUF6S1EsaUJBQWlCO0lBOUM3QixnQkFBUyxDQUFDO1FBQ1AsUUFBUSxFQUFFLFdBQVc7UUFDckIsUUFBUSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztLQTBCVDtRQUNELE1BQU0sRUFBRSxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7S0FlUixDQUFDO0tBQ0wsQ0FBQztxQ0EwQjBCLGlCQUFVO0dBekJ6QixpQkFBaUIsQ0EwTTdCO0FBMU1ZLDhDQUFpQiIsImZpbGUiOiJidXNpbmVzcy90YWJsZS90YWJsZS5jb21wb25lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyAgTmdNb2R1bGUgLENvbXBvbmVudCwgT25Jbml0LEV2ZW50RW1pdHRlcixPdXRwdXQsIE9uRGVzdHJveSxFbGVtZW50UmVmICxJbnB1dCxDb250ZW50Q2hpbGQsVGVtcGxhdGVSZWZ9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgdG9Cb29sZWFuIH0gZnJvbSAnLi9jb252ZXJ0JztcbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnY210LXRhYmxlJyxcbiAgICB0ZW1wbGF0ZTogYFxuICAgICAgPGRpdiBzdHlsZT1cIndpZHRoOjEwMCU7b3ZlcmZsb3cteDogYXV0bztcIj5cbiAgICAgICAgICA8ZGl2ICpuZ0lmPVwiX2xhbmdsZWZ0PT0nbGVmdCdcIiBbbmdTdHlsZV09XCJ7J3dpZHRoJzpfZml4ZWR3aWR0aGxlZnR9XCIgc3R5bGU9XCJwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3gtc2hhZG93OnJnYmEoMCwgMCwgMCwgMC4yKSAycHggMHB4IDZweCAtMnB4O292ZXJmbG93OmhpZGRlblwiPlxuICAgICAgICAgICAgICA8dGFibGUgW25nQ2xhc3NdPVwieydiYXNpY3MnOiBfYmFzaWNzLCAnZnJhbWUnOl9mcmFtZX1cIiBjZWxsc3BhY2luZz1cIjBcIiBjZWxscGFkZGluZz1cIjBcIj5cbiAgICAgICAgICAgICAgICAgIDwhLS1iYXNpY3M65Z+656GAO2ZyYW1lOuWkluahhjstLT5cbiAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgICA8dGFibGUgW25nQ2xhc3NdPVwieydiYXNpY3MnOiBfYmFzaWNzLCAnZnJhbWUnOl9mcmFtZX1cIiBjZWxsc3BhY2luZz1cIjBcIiBjZWxscGFkZGluZz1cIjBcIj5cbiAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgPC90YWJsZT5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8ZGl2ICpuZ0lmPVwiX2xhbmdyaWdodD09J3JpZ2h0J1wiIFtuZ1N0eWxlXT1cInsnd2lkdGgnOl9maXhlZHdpZHRocmlndGgsJ2hlaWdodCc6X2hlaWdodH1cIiBzdHlsZT1cImJvcmRlcjoxcHggc29saWQgI2NjYztib3JkZXItbGVmdDpub25lO2JvcmRlci1ib3R0b206bm9uZTt3aWR0aDoyMDBweDtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtyaWdodDowO2JveC1zaGFkb3c6cmdiYSgwLCAwLCAwLCAwLjIpIC0ycHggMHB4IDZweCAtMnB4O292ZXJmbG93OmhpZGRlblwiPlxuICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246cmVsYXRpdmU7XCI+XG4gICAgICAgICAgICAgICAgICA8ZGl2IHN0eWxlPVwicG9zaXRpb246IGFic29sdXRlO3JpZ2h0OiAwO1wiPlxuICAgICAgICAgICAgICAgICAgICAgIDx0YWJsZSBbbmdDbGFzc109XCJ7J2Jhc2ljcyc6IF9iYXNpY3N9XCIgY2VsbHNwYWNpbmc9XCIwXCIgY2VsbHBhZGRpbmc9XCIwXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxuZy1jb250YWluZXIgW25nVGVtcGxhdGVPdXRsZXRdPVwidGVtcGxhdGVcIj48L25nLWNvbnRhaW5lcj5cbiAgICAgICAgICAgICAgICAgICAgICA8L3RhYmxlPlxuICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8bnotcGFnaW5hdGlvbiAqbmdJZj1cIm56SXNQYWdpbmF0aW9uJiZkYXRhLmxlbmd0aFwiIFtuekluVGFibGVdPVwidHJ1ZVwiIFtuelNob3dTaXplQ2hhbmdlcl09XCJuelNob3dTaXplQ2hhbmdlclwiIFtuelBhZ2VTaXplU2VsZWN0b3JWYWx1ZXNdPVwibnpQYWdlU2l6ZVNlbGVjdG9yVmFsdWVzXCIgW256U2hvd1F1aWNrSnVtcGVyXT1cIm56U2hvd1F1aWNrSnVtcGVyXCIgW256U2hvd1RvdGFsXT1cIm56U2hvd1RvdGFsXCIgW256U2l6ZV09XCIobnpTaXplPT0nbWlkZGxlJ3x8bnpTaXplPT0nc21hbGwnKT8nc21hbGwnOicnXCJcbiAgICAgICAgICBbKG56UGFnZVNpemUpXT1cIm56UGFnZVNpemVcIiBbbnpUb3RhbF09XCJuelRvdGFsXCIgWyhuelBhZ2VJbmRleCldPVwibnpQYWdlSW5kZXhcIiAobnpQYWdlSW5kZXhDbGlja0NoYW5nZSk9XCJwYWdlQ2hhbmdlQ2xpY2soJGV2ZW50KVwiPlxuICAgICAgPC9uei1wYWdpbmF0aW9uPlxuICAgIGAsXG4gICAgc3R5bGVzOiBbYFxuICAgICAgdGFibGUge1xuICAgICAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO1xuICAgICAgICBib3JkZXItc3BhY2luZzogMDtcbiAgICAgIH1cbiAgICAgIC5iYXNpY3Mge1xuICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgdGFibGUtbGF5b3V0OiBmaXhlZDtcbiAgICAgIH1cbiAgICAgIC5iYXNpY3MgdGFibGUgdGJvZHkgdHI6aG92ZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOiByZWQ7XG4gICAgICB9XG4gICAgICAuZnJhbWUge1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjY2NjO1xuICAgICAgfVxuICAgIGBdLFxufSlcbmV4cG9ydCBjbGFzcyBUYWJsZURvY0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgICBfbGFuZ2xlZnQ6IHN0cmluZztcbiAgICBfbGFuZ3JpZ2h0OiBzdHJpbmc7XG4gICAgX2Jhc2ljczpib29sZWFuO1xuICAgIF9mcmFtZTpib29sZWFuO1xuICAgIF9kYXRhczphbnk7XG4gICAgX2ZpeGVkd2lkdGhsZWZ0OmFueTtcbiAgICBfZml4ZWR3aWR0aHJpZ3RoOmFueTtcbiAgICBfaGVpZ2h0OmFueTtcbiAgICBkYXRhc3JpZ2h0OmFueTtcbiAgICBfcGFnZVNpemUgPSAxMDtcbiAgICBfdG90YWw6IG51bWJlcjtcbiAgICBfY3VycmVudCA9IDE7XG4gICAgX2lzSW5pdCA9IGZhbHNlO1xuICAgIF9pc0FqYXggPSBmYWxzZTtcbiAgICBfZGF0YVNldDogYW55W10gPSBbXTtcbiAgICBkYXRhOiBhbnlbXSA9IFtdO1xuXG4gICAgcHJpdmF0ZSBfaXNQYWdpbmF0aW9uID0gdHJ1ZTtcbiAgICBwcml2YXRlIF9zaG93U2l6ZUNoYW5nZXIgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9zaG93UXVpY2tKdW1wZXIgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9zaG93VG90YWwgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9pc1BhZ2VJbmRleFJlc2V0ID0gdHJ1ZTtcblxuICAgIC8vLy8vXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBlbDogRWxlbWVudFJlZikge1xuXG4gICAgfVxuICAgIFxuICAgIEBPdXRwdXQoKSBuelBhZ2VTaXplQ2hhbmdlOiBFdmVudEVtaXR0ZXI8bnVtYmVyPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgbnpQYWdlSW5kZXhDaGFuZ2U6IEV2ZW50RW1pdHRlcjxudW1iZXI+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIEBPdXRwdXQoKSBuelBhZ2VJbmRleENoYW5nZUNsaWNrOiBFdmVudEVtaXR0ZXI8bnVtYmVyPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgbnpEYXRhQ2hhbmdlOiBFdmVudEVtaXR0ZXI8YW55W10+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgLy8vLy9cbiAgICBASW5wdXQoKVxuICAgIHNldCBsYW5nbGVmdChsZWZ0OiBhbnkpIHtcbiAgICAgICAgdGhpcy5fbGFuZ2xlZnQgPSBsZWZ0O1xuICAgIH07XG4gICAgQElucHV0KClcbiAgICBzZXQgbGFuZ3JpZ2h0KHJpZ2h0OiBhbnkpIHtcbiAgICAgICAgdGhpcy5fbGFuZ3JpZ2h0ID0gcmlnaHQ7XG4gICAgfTtcbiAgICBAQ29udGVudENoaWxkKFRlbXBsYXRlUmVmKSB0ZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcbiAgICBASW5wdXQoKVxuICAgIHNldCBiYXNpY3MoYmFzaWNzOiBhbnkpIHtcbiAgICAgICAgdGhpcy5fYmFzaWNzID0gYmFzaWNzO1xuICAgIH07XG4gICAgQElucHV0KClcbiAgICBzZXQgZnJhbWUoZnJhbWU6IGFueSkge1xuICAgICAgICB0aGlzLl9mcmFtZSA9IGZyYW1lO1xuICAgIH07XG4gICAgQElucHV0KClcbiAgICBzZXQgZGF0YXMoZGF0YTogYW55KSB7XG4gICAgICAgIHRoaXMuX2RhdGFzID0gZGF0YSA7XG4gICAgICAgIC8vIDtcbiAgICAgICAgZm9yKGxldCBpPTA7aTx0aGlzLl9kYXRhcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgIGlmKFwiZml4ZWRcIiBpbiB0aGlzLl9kYXRhc1tpXSl7IFxuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2RhdGFzW2ldLmZpeGVkPT1cImxlZnRcIil7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xhbmdsZWZ0PXRoaXMuX2RhdGFzW2ldLmZpeGVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9maXhlZHdpZHRobGVmdD10aGlzLl9kYXRhc1tpXS53aWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYodGhpcy5fZGF0YXNbaV0uZml4ZWQ9PVwicmlnaHRcIil7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xhbmdyaWdodD10aGlzLl9kYXRhc1tpXS5maXhlZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZml4ZWR3aWR0aHJpZ3RoPXRoaXMuX2RhdGFzW2ldLndpZHRoO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oZWlnaHQ9KHRoaXMuX2RhdGFzLmxlbmd0aCArIDEpKjMyK1wicHhcIjtcbiAgICAgICAgICAgICAgICAgICAgLy8gO1xuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBASW5wdXQoKVxuICAgIHNldCB3aWR0aGxlZnQoZml4ZWR3aWR0aDogYW55KSB7XG4gICAgICAgIHRoaXMuX2ZpeGVkd2lkdGhsZWZ0ID0gZml4ZWR3aWR0aDtcbiAgICB9O1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IHdpZHRocmlnaHQoZml4ZWR3aWR0aDogYW55KSB7XG4gICAgICAgIHRoaXMuX2ZpeGVkd2lkdGhyaWd0aCA9IGZpeGVkd2lkdGg7XG4gICAgfTtcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICBASW5wdXQoKVxuICAgIHNldCBuekRhdGFTb3VyY2UodmFsdWU6IGFueVtdKSB7XG4gICAgICAgIHRoaXMuX2RhdGFTZXQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5uelRvdGFsID0gdGhpcy5fZGF0YVNldC5sZW5ndGg7XG4gICAgICAgIHRoaXMuX2dlbmVyYXRlRGF0YSh0cnVlKTtcbiAgICB9XG5cbiAgICBnZXQgbnpEYXRhU291cmNlKCk6IGFueVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFTZXQ7XG4gICAgfVxuICAgIEBJbnB1dCgpXG4gICAgc2V0IG56SXNQYWdpbmF0aW9uKHZhbHVlOiBib29sZWFuKSB7XG4gICAgICB0aGlzLl9pc1BhZ2luYXRpb24gPSB0b0Jvb2xlYW4odmFsdWUpO1xuICAgIH1cbiAgXG4gICAgZ2V0IG56SXNQYWdpbmF0aW9uKCk6IGJvb2xlYW4ge1xuICAgICAgcmV0dXJuIHRoaXMuX2lzUGFnaW5hdGlvbjtcbiAgICB9XG4gICAgQElucHV0KClcbiAgICBzZXQgbnpTaG93U2l6ZUNoYW5nZXIodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy5fc2hvd1NpemVDaGFuZ2VyID0gdG9Cb29sZWFuKHZhbHVlKTtcbiAgICB9XG4gICAgQElucHV0KCkgbnpQYWdlU2l6ZVNlbGVjdG9yVmFsdWVzID0gWzEwLCAyMCwgMzAsIDQwLCA1MF07XG5cbiAgICBnZXQgbnpTaG93U2l6ZUNoYW5nZXIoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zaG93U2l6ZUNoYW5nZXI7XG4gICAgfVxuXG4gICAgQElucHV0KClcbiAgICBzZXQgbnpTaG93UXVpY2tKdW1wZXIodmFsdWU6IGJvb2xlYW4pIHtcbiAgICAgIHRoaXMuX3Nob3dRdWlja0p1bXBlciA9IHRvQm9vbGVhbih2YWx1ZSk7XG4gICAgfVxuICBcbiAgICBnZXQgbnpTaG93UXVpY2tKdW1wZXIoKTogYm9vbGVhbiB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd1F1aWNrSnVtcGVyO1xuICAgIH1cbiAgICBASW5wdXQoKVxuICAgIHNldCBuelNob3dUb3RhbCh2YWx1ZTogYm9vbGVhbikge1xuICAgICAgdGhpcy5fc2hvd1RvdGFsID0gdG9Cb29sZWFuKHZhbHVlKTtcbiAgICB9XG4gIFxuICAgIGdldCBuelNob3dUb3RhbCgpOiBib29sZWFuIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93VG90YWw7XG4gICAgfVxuICAgIEBJbnB1dCgpIG56U2l6ZTogc3RyaW5nO1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IG56UGFnZVNpemUodmFsdWU6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5fcGFnZVNpemUgPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wYWdlU2l6ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLl9nZW5lcmF0ZURhdGEoKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzSW5pdCkge1xuICAgICAgICB0aGlzLm56UGFnZVNpemVDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgbnpQYWdlU2l6ZSgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFnZVNpemU7XG4gICAgfVxuICAgIEBJbnB1dCgpXG4gICAgc2V0IG56VG90YWwodmFsdWU6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5fdG90YWwgPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl90b3RhbCA9IHZhbHVlO1xuICAgIH1cblxuICAgIGdldCBuelRvdGFsKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl90b3RhbDtcbiAgICB9XG4gICAgQElucHV0KClcbiAgICBzZXQgbnpQYWdlSW5kZXgodmFsdWU6IG51bWJlcikge1xuICAgICAgICBpZiAodGhpcy5fY3VycmVudCA9PT0gdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2N1cnJlbnQgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5fZ2VuZXJhdGVEYXRhKCk7XG4gICAgICAgIHRoaXMubnpQYWdlSW5kZXhDaGFuZ2UuZW1pdCh0aGlzLm56UGFnZUluZGV4KTtcbiAgICB9XG5cbiAgICBnZXQgbnpQYWdlSW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnQ7XG4gICAgfVxuXG4gICAgQElucHV0KClcbiAgICBzZXQgbnpJc1BhZ2VJbmRleFJlc2V0KHZhbHVlOiBib29sZWFuKSB7XG4gICAgICB0aGlzLl9pc1BhZ2VJbmRleFJlc2V0ID0gdG9Cb29sZWFuKHZhbHVlKTtcbiAgICB9XG4gIFxuICAgIGdldCBueklzUGFnZUluZGV4UmVzZXQoKTogYm9vbGVhbiB7XG4gICAgICByZXR1cm4gdGhpcy5faXNQYWdlSW5kZXhSZXNldDtcbiAgICB9XG4gICAgX2dlbmVyYXRlRGF0YShmb3JjZVJlZnJlc2g6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQge1xuICAgICAgICA7XG4gICAgICAgIGlmICghdGhpcy5faXNBamF4KSB7XG4gICAgICAgIGlmICh0aGlzLm56SXNQYWdpbmF0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZm9yY2VSZWZyZXNoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5ueklzUGFnZUluZGV4UmVzZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm56UGFnZUluZGV4ID0gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWF4UGFnZUluZGV4ID0gTWF0aC5jZWlsKHRoaXMuX2RhdGFTZXQubGVuZ3RoIC8gdGhpcy5uelBhZ2VTaXplKTtcbiAgICAgICAgICAgICAgICB0aGlzLm56UGFnZUluZGV4ID0gIXRoaXMubnpQYWdlSW5kZXggPyAxIDogKHRoaXMubnpQYWdlSW5kZXggPiBtYXhQYWdlSW5kZXggPyBtYXhQYWdlSW5kZXggOiB0aGlzLm56UGFnZUluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuX2RhdGFTZXQuc2xpY2UoKHRoaXMubnpQYWdlSW5kZXggLSAxKSAqIHRoaXMubnpQYWdlU2l6ZSwgdGhpcy5uelBhZ2VJbmRleCAqIHRoaXMubnpQYWdlU2l6ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLl9kYXRhU2V0O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubnpEYXRhQ2hhbmdlLmVtaXQodGhpcy5kYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwYWdlQ2hhbmdlQ2xpY2sodmFsdWU6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB0aGlzLm56UGFnZUluZGV4Q2hhbmdlQ2xpY2suZW1pdCh2YWx1ZSk7XG4gICAgICB9XG4gICAgbmdPbkluaXQoKSB7XG4gICAgfTtcbiAgICBuZ09uRGVzdHJveSgpIHtcblxuICAgIH07XG5cbn0iXX0=
