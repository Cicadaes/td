<main>
    <!--新建删除操作-->
    <div class="new-build-button">
        <button [disabled]="isDisabled" type="button" (click)="newBuild()" ><span>+</span>新建指标</button>
    </div>
    <!--搜索-->
    <div class="search-box">
        <input type="text" placeholder="请输入关键字" [(ngModel)]="searchName" class="change-name"   />
        <button class="search-btn" pButton type="button" (click)="search()" label="查询"></button>
        <button class="cancel-btn" type="button" (click)="cancelSearch()" >取消</button>
    </div>
    <!--展示查询提交过的列表数据-->
    <table *ngIf="updateTableList.length" width="100%" border="0" cellspacing="0" cellpadding="0" class="tab-activity">
        <tr>
            <th style="width:15%" scope="col" >指标名称</th>
            <th style="width:15%" scope="col" >cube-code</th>
            <th style="width:15%" scope="col" >描述</th>
            <th style="width:10%" scope="col" >创建人</th>
            <th style="width:11%" scope="col" >创建时间</th>
            <th style="width:8%" scope="col" >规则/条件</th>
            <th style="width:8%" scope="col" >触发器-指标</th>
            <th style="width:8%" scope="col" >计划目标</th>
            <th style="width:10%" scope="col">操作</th>
        </tr>
        <tr *ngFor = "let item of updateTableList; let i=index" >
            <td>
                <span [title]="item.name">{{item.name}}</span>
            </td>
            <td>
                <span [title]="item.code">{{item.code}}</span>
            </td>
            <td [title]="item.description || ''">
                <div class="description">{{item.description}}</div>
            </td>
            <td>
                <span [title]="item.creator">{{item.creator}}</span>
            </td>
            <td>
                <span [title]="item.createTime | date:'yyyy-MM-dd HH:mm'">{{item.createTime | date:'yyyy-MM-dd HH:mm'}}</span>
            </td>
            <td style="padding-left: 25px;"><p-checkbox [disabled]="true" [(ngModel)]="item.ruleFlag" binary="true"></p-checkbox></td>
            <td style="padding-left: 25px;"><p-checkbox [disabled]="true" [(ngModel)]="item.triggerFlag" binary="true"></p-checkbox></td>
            <td style="padding-left: 25px;"><p-checkbox [disabled]="true" [(ngModel)]="item.planFlag" binary="true"></p-checkbox></td>
            <td>
                <button class="change" type="button" (click)="change(item)" >编辑</button>
                <button *ngIf="false" class="del" type="button" (click)="delete(item)" >删除</button> 
            </td>
        </tr>
        
    </table>
    <p-growl [value]="msgs" life="3000"></p-growl>
    <!--添加无数据显示语句-->
    <p class="tip" *ngIf="!updateTableList.length">暂时没有数据...</p>
    <!--新建/修改弹框-->
    <p-dialog [header]="dialogHeader" (onAfterHide) = "dialogHide()" [(visible)]="newDisplay" [draggable]="false" modal="modal" >
        <div class="clearfix">
            <div class="l" style="width: 20%;">
                <span style="line-height: 30px;">指标名称：</span>
            </div>
            <div class="l" style="width:70%;">
                <input type="text" style="width:100%;" [(ngModel)]="configInfo.name" class="change-name" />  
            </div>          
        </div>
        <div class="event-div clearfix" *ngIf="!configInfo.id && newDisplay">
            <div class="l" style="width: 20%;">
                <span style="line-height: 30px;">指标选择：</span>
            </div>
            <div class="l" style="width:70%;">
                <p-dropdown (onChange) = "changeSel()" [options]="selList" [(ngModel)]="selectedValue" [style]="{'width':'100%'}" filter="filter"></p-dropdown>
            </div>
        </div>
        <div class="event-div clearfix">
            <div class="r" style="width:80%;">
                <p-checkbox [(ngModel)]="configInfo.ruleFlag" binary="true" label="规则/条件"></p-checkbox>
                <p-checkbox style="margin: 0 20px;" [(ngModel)]="configInfo.triggerFlag" binary="true" label="触发器-指标"></p-checkbox>
                <p-checkbox [(ngModel)]="configInfo.planFlag" binary="true" label="计划目标"></p-checkbox>
            </div>
        </div>
        <div class="clearfix">
            <div class="l" style="width: 20%;">
                <span class="desc" style="line-height: 30px;">指标描述：</span>
            </div>
            <div class="l" style="width:70%;">
                <textarea (keyup)="textareaChange()" class="textarea" [(ngModel)]="configInfo.description"></textarea>
            </div>
        </div>
        <p *ngIf="desWarnShow" class="warn-tip"><i class="iconfonts icon-empty1"></i>描述长度不能超过240个字符</p>
        <p-footer>
            <div class="config-handel">
                <div (click)="confirmNew()" ><i class="fa fa-check"></i>保存</div>
                <div (click)="cancelNew()">取消</div>
            </div>
        </p-footer>
    </p-dialog>
    <!--提示活动在进行不能操作  -->
    <p-dialog (onAfterHide) = "noticeDialogHide()" header="提示" [(visible)]="isActive" [draggable]="false" modal="modal" >
        <p class="is-active">活动正在进行中，请勿操作！</p>
        <p-footer>
            <div class="config-handel">
                <div (click)="confirmActive()"><i class="fa fa-check"></i>确定</div>
                <div (click)="cancelActive()" >取消</div>
            </div>
        </p-footer>
    </p-dialog>
    <!--删除确认弹框-->
    <p-confirmDialog width="304" height="150" [acceptLabel]="acceptLabel" [rejectLabel]="rejectLabel"></p-confirmDialog>
    <!--分页-->
    <div>
        <x-paginator [value]="value" (onPagesChange)="paginate($event)"></x-paginator>
    </div>
</main>