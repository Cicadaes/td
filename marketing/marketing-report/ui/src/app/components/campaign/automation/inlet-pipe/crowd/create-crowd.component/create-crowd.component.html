<main class="create-crowd">
    <p-dialog header="{{name}}" width="{{wt}}" height="{{ht}}" [(visible)]="show" [draggable]="false" [resizable]="false" [contentStyle]="{'height': 'calc(100% - 75px)', 'padding': '0px', 'overflow': 'hidden'}" modal="true" responsive="true" (onAfterHide)="afterDialogHide()">
        <my-iframe [src]="src" *ngIf="show && (tp =='scene' || tp == 'lookalike')"></my-iframe>
        <div [ngClass]="{'id-update-box':'true','show': tp == 'precise', 'hide': tp !== 'precise'}">
            <div>
                <h3>人群名称</h3>
                <div class="content">
                    <input [(ngModel)]="crowdName" type="text" pInputText (keyup)="changeName()" placeholder="请输入人群名称">
                </div>
                <p *ngIf="isErr" class="warn-tip"><i class="fa fa-exclamation-circle"></i>{{errMsg}}</p>
            </div>
            <div class="file-update">
                <div class="upload-box clearfix">
                    <div class="l upload-area">
                        <div class="upload-show" [ngClass]="{'change-bg' : changeBg}" (click)="clickUploadInput()">
                            <i class="fa fa-upload"></i>
                            <span>上传文件</span>
                        </div>
                        <input id="uploadCsv" [ngClass]="{'show-update' : showUpdate}" class="upload-input" type="file" accept=".csv" (change)="selectFile($event)">
                    </div>
                    <p *ngIf="!csvFileName || isFileErr" class="l download"><a href="/marketing/public/template/上传模板.zip">模板下载</a><i class="fa fa-exclamation-circle"></i>请上传CSV格式文件，文件大小不能超过2M</p>
                    <div *ngIf="csvFileName && !isFileErr" class="l upload-file-name">
                        <span>{{csvFileName}}</span>
                        <span class="clear-file" (click)="clearFile()">清除</span>
                    </div>
                </div>
                <p *ngIf="noFile" class="warn-tip"><i class="fa fa-exclamation-circle"></i>请先上传文件。</p>
                <p class="preview">预览效果
                    <span *ngIf="csvFileName && !isFileErr">文件中共包含 ：{{csvData['tdId'] || 0}}个TDID | {{csvData['phoneNum'] || 0}}个手机号 | {{csvData['IMEI'] || 0}}个IMEI | {{csvData['IDFA'] || 0}}个IDFA | {{csvData['AndroidId'] || 0}}个AndroidId | {{csvData['MAC'] || 0}}个MAC | {{csvData['email'] || 0}}个email</span>
                    <span style="color: #ff6e6b" *ngIf="isFileErr && !noFile">{{isFileErrMsg}}</span>
                </p>
                <div class="tabel default" *ngIf="isFileErr">
                    <span>因上传文件存在异常值无法正常显示...</span>
                </div>
                <div class="tabel default" *ngIf="!isFileErr && tableTitle.length===0">
                    <span>文件...</span>
                </div>
                <div class="tabel" *ngIf="!isFileErr && tableTitle.length!==0">
                    <table>
                        <tr class="title">
                            <th [title]="i" *ngFor="let i of tableTitle">{{i}}</th>
                        </tr>
                        <tr *ngFor="let j of tableList">
                            <td [title]="j[i]" *ngFor="let i of tableTitle">{{j[i]}}</td>
                        </tr>
                    </table>
                </div>
                <div class="previewVariable" *ngIf="!isFileErr && quotes && quotes.length!==0">
                    <p>消息体可引用变量</p>
                    <ul class="json-list clearfix">
                        <li *ngFor="let i of quotes">
                            <i class="triangle"></i>
                            <!--<i class="radius"></i>
                            <i class="json-add"></i>-->
                            <span (click)="jsonInsert('{greet}')">{{'+{$' + i + '}'}}</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="r btn-handel">
                <button class="cancel" pButton type="text" (click)="cancel()" label="取消"></button>
                <button [disabled]="isDisabled" class="confirm" pButton type="text" (click)="createCrowd()" label="确定"></button>
            </div>
        </div>
    </p-dialog>
</main>