<nz-modal [(nzVisible)]="isVisible" [nzTitle]="modalTitle" [nzContent]="modalContent" [nzFooter]="modalFooter"
    (nzOnCancel)="handleCancel($event)" [nzMaskClosable]='false' [nzWidth]="'663px'">
    <ng-template #modalTitle>
        <span *ngIf="editFlag === 'add'">新建接口</span>
        <span *ngIf="editFlag === 'edit'">修改接口基础信息</span>
        <span *ngIf="editFlag === 'copy'">复制接口</span>
    </ng-template>
    <ng-template #modalContent>
        <form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm()" autocomplete="off">
            <nz-form-item *ngIf="editFlag === 'copy'" style="margin-bottom: 6px;">
                <nz-form-label [nzSpan]="4" nzRequired nzFor="name" class="cover-ant-form-item-label">源接口名称</nz-form-label>
                <nz-form-control [nzSpan]="20"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{editData.name}}">{{editData.name}}</div></nz-form-control>
            </nz-form-item>

            <nz-form-item *ngIf="editFlag === 'copy'" style="margin-bottom: 6px;">
                <nz-form-label [nzSpan]="4" nzRequired nzFor="description" class="cover-ant-form-item-label">源接口描述</nz-form-label>
                <nz-form-control [nzSpan]="20"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{editData.description}}">{{editData.description}}</div></nz-form-control>
            </nz-form-item>

            <nz-form-item *ngIf="editFlag === 'copy'" style="margin-bottom: 14px;">
                <nz-form-label [nzSpan]="4" nzRequired nzFor="description" class="cover-ant-form-item-label">源接口版本</nz-form-label>
                <nz-form-control [nzSpan]="20"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{editData.versionName}}">{{editData.versionName}}</div></nz-form-control>
            </nz-form-item>

            <nz-form-item>
                <nz-form-label [nzSpan]="4" nzRequired nzFor="name" *ngIf="editFlag !== 'copy'">接口名称</nz-form-label>
                <nz-form-label [nzSpan]="4" nzRequired nzFor="name" *ngIf="editFlag === 'copy'">新接口名称</nz-form-label>
                <nz-form-control [nzSpan]="20">
                    <input id="name" type="name" nz-input formControlName="name" placeholder="请输入接口名称">
                    <nz-form-explain style="color:red;" *ngIf="getFormControl('name').dirty && getFormControl('name').errors" style="color: #f5222d;">
                        <ng-container *ngIf="getFormControl('name').errors.required">
                            请输入接口名称
                        </ng-container>
                        <ng-container *ngIf="getFormControl('name').errors.pattern">
                            开头结尾不能有空格
                        </ng-container>
                        <ng-container *ngIf="getFormControl('name').errors.forbiddenName && !getFormControl('name').errors.pattern">
                            只能输入中文、数字、英文字母、“-_&”、空格，长度最少2个字符、最多100个字符
                        </ng-container>
                    </nz-form-explain>
                </nz-form-control>
            </nz-form-item>

            <nz-form-item [ngStyle]="{'margin-bottom': editFlag === 'edit' || editFlag === 'add' ? '14px': ''}">
                <nz-form-label [nzSpan]="4" nzRequired nzFor="catalogId">所属分类</nz-form-label>
                <nz-form-control [nzSpan]="20" *ngIf="editFlag === 'copy'">
                    <nz-select (ngModelChange)="select($event)" [(ngModel)]="selectedOption" nzShowSearch nzPlaceHolder="请选择所属分类"
                        formControlName="catalogId">
                        <nz-option-group *ngFor="let group of productList" [nzLabel]="group.name">
                            <nz-option nzCustomContent *ngFor="let item of group.children" [nzLabel]="item.name"
                                [nzValue]="item.id">
                                <span style="display: block;" title="{{item.name}}">{{item.name}}</span>
                            </nz-option>
                        </nz-option-group>
                    </nz-select>
                    <nz-form-explain style="color:red;" *ngIf="getFormControl('catalogId').dirty && getFormControl('catalogId').errors"
                        style="color: #f5222d;">
                        <ng-container *ngIf="getFormControl('catalogId').errors.required">
                            请选择所属分类
                        </ng-container>
                    </nz-form-explain>
                </nz-form-control>
                <nz-form-control [nzSpan]="20" *ngIf="editFlag === 'edit'"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{editData.catalogName}}">{{editData.catalogName}}</div></nz-form-control>
                <nz-form-control [nzSpan]="20" *ngIf="editFlag === 'add'"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{catalogName}}">{{catalogName}}</div></nz-form-control>

            </nz-form-item>

            <nz-form-item [ngStyle]="{'margin-bottom': editFlag === 'edit' ? '14px': ''}">
                <nz-form-label [nzSpan]="4" nzRequired nzFor="versionId" style="text-align: left;">版本</nz-form-label>
                <nz-form-control [nzSpan]="20" *ngIf="editFlag !== 'edit'">
                    <nz-select formControlName="versionId" [nzSize]="'default'" nzPlaceHolder="请选择版本" nzShowSearch
                        [(ngModel)]="selectedVersion">
                        <nz-option nzCustomContent *ngFor="let option of versionOptions" [nzLabel]="option.version"
                            [nzValue]="option.id">
                            <span style="display: block;" title="{{option.version}}">{{option.version}}</span>
                        </nz-option>
                    </nz-select>
                    <nz-tooltip [nzTitle]="'请在一级产品分类中管理版本信息。'" [nzPlacement]="'left'" nzTrigger="click">
                        <i class="anticon anticon-question-circle" nz-tooltip style="position: absolute;right: -19px;top: 0px; cursor: pointer;"></i>
                    </nz-tooltip>
                    <nz-form-explain style="color:red;" *ngIf="getFormControl('versionId').dirty && getFormControl('versionId').errors"
                        style="color: #f5222d;">
                        <ng-container *ngIf="getFormControl('versionId').errors.required">
                            请选择版本
                        </ng-container>
                    </nz-form-explain>
                </nz-form-control>
                <nz-form-control [nzSpan]="20" *ngIf="editFlag === 'edit'" style="margin-bottom: 14px;"><div style="overflow: hidden;
                    text-overflow: ellipsis;
                    white-space: nowrap;" title="{{editData.versionName}}">{{editData.versionName}}</div></nz-form-control>
            </nz-form-item>

            <nz-form-item>
                <nz-form-label [nzSpan]="4" nzRequired nzFor="description" style="text-align: left;">接口描述</nz-form-label>
                <nz-form-control [nzSpan]="20" style="float: right;">
                    <textarea id="description" type="description" nz-input formControlName="description" placeholder="请输入接口描述"></textarea>
                    <nz-form-explain style="color:red;" *ngIf="getFormControl('description').dirty && getFormControl('description').errors"
                        style="color: #f5222d;">
                        <ng-container *ngIf="getFormControl('description').errors.required">
                            请输入接口描述
                        </ng-container>
                        <ng-container *ngIf="getFormControl('description').errors.maxlength && !getFormControl('description').errors.pattern">
                            接口描述不能超过256个字符
                        </ng-container>
                        <ng-container *ngIf="getFormControl('description').errors.minlength && !getFormControl('description').errors.pattern">
                            接口描述不能少于5个字符
                        </ng-container>
                        <ng-container *ngIf="getFormControl('description').errors.pattern">
                            开头结尾不能有空格
                        </ng-container>
                    </nz-form-explain>
                </nz-form-control>
            </nz-form-item>
        </form>
    </ng-template>
    <ng-template #modalFooter>
        <button nz-button [nzType]="'default'" [nzSize]="large" (click)="handleCancel($event)">
            取 消
        </button>
        <button nz-button [nzType]="'primary'" [nzSize]="large" (click)="save()">
            确 定
        </button>
    </ng-template>
</nz-modal>